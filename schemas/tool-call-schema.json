{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://sadie.local/schemas/tool-call.json",
  "title": "Tool Call Response",
  "description": "Schema for Ollama's structured tool-calling response",
  "type": "object",
  "required": ["response"],
  "properties": {
    "response": {
      "type": "string",
      "description": "Natural language response to the user",
      "minLength": 1
    },
    "tool_call": {
      "oneOf": [
        { "type": "null" },
        {
          "type": "object",
          "required": ["tool_name", "parameters"],
          "properties": {
            "tool_name": {
              "type": "string",
              "enum": [
                "file_manager",
                "email_manager",
                "vision_tool",
                "voice_tool",
                "planning_agent",
                "api_tool",
                "memory_manager",
                "search_tool",
                "system_info"
              ],
              "description": "Name of the tool to invoke"
            },
            "parameters": {
              "type": "object",
              "description": "Tool-specific parameters (validated against tool schema)"
            },
            "reasoning": {
              "type": "string",
              "description": "Explanation of why this tool was selected"
            },
            "confidence": {
              "type": "number",
              "minimum": 0,
              "maximum": 1,
              "description": "Confidence level in tool selection (0-1)"
            }
          }
        }
      ]
    },
    "requires_clarification": {
      "type": "boolean",
      "description": "Whether the request needs more information from the user"
    },
    "clarification_questions": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Questions to ask the user for clarification"
    }
  }
}
